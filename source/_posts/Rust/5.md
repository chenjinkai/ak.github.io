---
title: "[ Rust笔记 四] 基础-函数"
categories: 
 - 技术
tags:
 - Rust
date: 2025/08/11 11:00:00
updated: 2025/08/11 11:00:00
---

### 成员方法

```
    trait Shape {
        fn area(&self) -> f64;//关联函数，参数被称为接收者
    }

    trait T {
        fn method1(self: Self);
        fn method2(self: &Self);
        fn method3(self: &mut Self);
    }
    // 上下两种写法是完全一样的
    trait T {
        fn method1(self);
        fn method2(&self);
        fn method3(&mut self);
    }
```
具有receiver参数的函数，我们称为“方法”​（method）​，可以通过变量实例使用小数点来调用。
没有receiver参数的函数，我们称为“静态函数”​（static function）​，可以通过类型加双冒号：:的方式来调用。

Rust中Self（大写S）和self（小写s）都是关键字，大写S的是类型名，小写s的是变量名。

```
    struct Circle {
        radius: f64,
    }
    impl Shape for Circle {
        // Self 类型就是 Circle
        // self 的类型是 &Self，即 &Circle
        fn area(&self) -> f64 {
            // 访问成员变量，需要用 self.radius
            std::f64::consts::PI ＊ self.radius ＊ self.radius
        }
    }
    fn main() {
        let c = Circle { radius : 2f64};
        // 第一个参数名字是 self，可以使用小数点语法调用
        println!("The area is {}", c.area());
    }
```

另一种写法“内在方法”

```
    impl Circle {
        fn get_radius(&self) -> f64 { self.radius }
    }
```
trait中可以包含方法的默认实现。如果这个方法在trait中已经有了方法体，那么在针对具体类型实现的时候，就可以选择不用重写。

<!--more-->

self参数甚至可以是Box指针类型self

```
    trait Shape {
        fn area(self: Box<Self>) -> f64;
    }
    struct Circle {
        radius: f64,
    }
    impl Shape for Circle {
        // Self 类型就是 Circle
        // self 的类型是 Box<Self>，即 Box<Circle>
        fn area(self : Box<Self>) -> f64 {
            // 访问成员变量，需要用 self.radius
            std::f64::consts::PI ＊ self.radius ＊ self.radius
        }
    }
    fn main() {
        let c = Circle { radius : 2f64};
        // 编译错误
        // c.area();
        let b = Box::new(Circle {radius : 4f64});
        // 编译正确
        b.area();
    }
```

